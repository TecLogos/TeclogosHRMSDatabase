
USE [master];
GO

-- Force disconnect all users connected to the target DB
ALTER DATABASE TeclogosHRMS_DEV SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
GO

-- Drop the database
DROP DATABASE IF EXISTS TeclogosHRMS_DEV;
GO

-- Recreate the database
CREATE DATABASE TeclogosHRMS_DEV;

ALTER DATABASE TeclogosHRMS_DEV 
MODIFY FILE (
    NAME = 'TeclogosHRMS_DEV',
    SIZE = 512MB                
);

ALTER DATABASE TeclogosHRMS_DEV 
MODIFY FILE (
    NAME = 'TeclogosHRMS_DEV_log',
    SIZE = 256MB                  
);
GO

-- Use the database
USE TeclogosHRMS_DEV;
GO

-- TABLE 1: EMPLOYEES --

CREATE TABLE [Employees] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [Code] NVARCHAR(20) NOT NULL UNIQUE,
    [FirstName] NVARCHAR(100) NOT NULL,
    [MiddleName] NVARCHAR(100) NULL,
    [LastName] NVARCHAR(100) NOT NULL,
    [Email] NVARCHAR(100) NULL,
    [MobileNumber] NVARCHAR(15) NOT NULL,
    [Extension] NVARCHAR(20) NULL,
    [Photo] VARBINARY(MAX) NULL,
    [ResidentialStatus] NVARCHAR(100) NULL,
    [DOB] DATE NULL,
    [PlaceOfBirth] NVARCHAR(100) NULL,
    [GenderTypeID] UNIQUEIDENTIFIER NULL,
    [BloodGroupID] UNIQUEIDENTIFIER NULL,
    [MaritalStatusID] UNIQUEIDENTIFIER NULL,
    [MarriageDate] DATE NULL,
    [Nationality] NVARCHAR(50) NULL,
    [Religion] NVARCHAR(50) NULL,
    [Caste] NVARCHAR(50) NULL,
    [PhysicallyChallenged] BIT DEFAULT 0,
    [InternationalEmployee] BIT DEFAULT 0,
    [HeightInCm] DECIMAL(5,2) NULL,
    [WeightInKG] DECIMAL(5,2) NULL,
    [IDentificationMark] NVARCHAR(50) NULL,
    [Hobby] NVARCHAR(100) NULL,
    [JoiningDate] DATE NOT NULL,
    [DepartmentID] UNIQUEIDENTIFIER NULL,
    [DesignationID] UNIQUEIDENTIFIER NULL,
    [ReportingManagerID] UNIQUEIDENTIFIER NULL,
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 2: GENDER TYPE --

CREATE TABLE [GenderType] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [Name] NVARCHAR(100) NOT NULL UNIQUE,
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 3: MARITAL STATUS --

CREATE TABLE [MaritalStatus] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [Name] NVARCHAR(100) NOT NULL UNIQUE,
    
       -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 4: BLOOD GROUP --

CREATE TABLE [BloodGroup] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [Name] NVARCHAR(100) NOT NULL UNIQUE,
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 5: DEPARTMENT --

CREATE TABLE [Department] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [Name] NVARCHAR(100) NOT NULL UNIQUE,
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 6: DESIGNATION --

CREATE TABLE [Designation] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [Name] NVARCHAR(100) NOT NULL UNIQUE,
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 7: SHIFTS --

CREATE TABLE [Shifts] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [Name] NVARCHAR(100) NOT NULL UNIQUE,
    [StartTime] TIME NOT NULL,
    [EndTime] TIME NOT NULL,
    [BreakDuration] TIME,
    [StandardHrs] TIME,
    [LateThreshold] TIME,
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 8: EMPLOYEE SHIFTS --

CREATE TABLE [EmployeeShifts] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [EmployeeID] UNIQUEIDENTIFIER NOT NULL,
    [ShiftID] UNIQUEIDENTIFIER NOT NULL,
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 9: RELATION TYPE --

CREATE TABLE [RelationType] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [Name] NVARCHAR(100) NOT NULL UNIQUE,
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 10: IDENTIFIER TYPE --

CREATE TABLE [IdentifierType] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [Name] NVARCHAR(100) NOT NULL UNIQUE,
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 11: LEAVE TYPE --

CREATE TABLE [LeaveType] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [Name] NVARCHAR(100) NOT NULL UNIQUE,
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 12: ROLES --

CREATE TABLE [Roles] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [Name] NVARCHAR(50) NOT NULL UNIQUE,
    [Description] NVARCHAR(200) NULL,
       
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 13: OFFICE HOLIDAYS --

CREATE TABLE [OfficeHolidays] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [Name] NVARCHAR(200) NOT NULL,
    [HolidayDate] DATE NOT NULL,
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 14: ATTENDANCE --

CREATE TABLE [Attendance] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [EmployeeID] UNIQUEIDENTIFIER NOT NULL,
    [ShiftID] UNIQUEIDENTIFIER NOT NULL,
    [AttendanceDate] DATE NOT NULL,
    [InTime] DATETIME2 NULL,
    [OutTime] DATETIME2 NULL,
    [Source] INT DEFAULT 0,
    
      -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 15: WORK BREAK --

CREATE TABLE [WorkBreak] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [EmployeeID] UNIQUEIDENTIFIER NOT NULL,
    [WorkBreakDate] DATE NOT NULL,
    [StartDateTime] DATETIME2 NULL,
    [EndDateTime] DATETIME2 NULL,
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 16: BANK DETAILS --

CREATE TABLE [BankDetails] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [EmployeeID] UNIQUEIDENTIFIER NOT NULL,
    [BankName] NVARCHAR(100) NOT NULL,
    [Branch] NVARCHAR(100) NULL,
    [IFSC] NVARCHAR(15) NOT NULL,
    [MICR] NVARCHAR(15) NOT NULL,
    [AccountType] NVARCHAR(50) NULL,
    [AccountNumber] NVARCHAR(20) NOT NULL,
    [NameAsPerRecord] NVARCHAR(200) NOT NULL,
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 17: FAMILY MEMBERS --

CREATE TABLE [FamilyMembers] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [EmployeeID] UNIQUEIDENTIFIER NOT NULL,
    [RelationTypeID] UNIQUEIDENTIFIER NOT NULL,
    [FirstName] NVARCHAR(100) NOT NULL,
    [MiddleName] NVARCHAR(100) NULL,
    [LastName] NVARCHAR(100) NOT NULL,
    [DOB] DATE NULL,
    [MobileNumber] NVARCHAR(15) NULL,
    [BloodGroupID] UNIQUEIDENTIFIER NULL,
    [Nationality] NVARCHAR(50) NULL,
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 18: IDENTIFIERS --

CREATE TABLE [Identifiers] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [EmployeeID] UNIQUEIDENTIFIER NOT NULL,
    [IdentifierTypeID] UNIQUEIDENTIFIER NOT NULL,
    [Number] NVARCHAR(50) NOT NULL,
    [IssuedDate] DATE NULL,
    [ExpiryDate] DATE NULL,
    [FileName] NVARCHAR(100) NULL,
    [FilePath] NVARCHAR(200) NULL,
    [Verified] DATETIME2 NULL,
    [VerifiedByID] UNIQUEIDENTIFIER NULL,
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 19: LEAVE REQUEST --

CREATE TABLE [LeaveRequest] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [EmployeeID] UNIQUEIDENTIFIER NOT NULL,
    [LeaveTypeID] UNIQUEIDENTIFIER NOT NULL,
    [FromDate] DATE NULL,
    [ToDate] DATE NULL,
    [Reason] NVARCHAR(500) NULL, 
    [Status] BIT NOT NULL,
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 20: EMPLOYEE GROUP --

CREATE TABLE [EmployeeGroup] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [Name] NVARCHAR(150) NOT NULL UNIQUE,         
    [Description] NVARCHAR(500) NULL,          
     
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 21: EMPLOYEE GROUP DETAIL--

CREATE TABLE [EmployeeGroupDetail] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [EmployeeGroupID] UNIQUEIDENTIFIER NOT NULL,
    [EmployeeID] UNIQUEIDENTIFIER NOT NULL,       
     
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO


-- TABLE 22: LEAVE APPROVAL WORKFLOW --

CREATE TABLE [LeaveApprovalWorkflow] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [LeaveRequestID] UNIQUEIDENTIFIER NOT NULL,
    [ApproverEmployeeGroupID] UNIQUEIDENTIFIER NOT NULL,
    [ApprovalLevel] NVARCHAR(50) NOT NULL,
    [ApprovalLevelOrder] INT NOT NULL,
    [ApprovedStatus] BIT NOT NULL,
    [Remark] NVARCHAR(500) NULL, 
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 23: PF ACCOUNT --

CREATE TABLE [PFAccount] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [EmployeeID] UNIQUEIDENTIFIER NOT NULL,
    [PFNumber] NVARCHAR(20) NOT NULL,
    [UAN] NVARCHAR(20) NOT NULL,
    [PFJoinDate] DATE NULL,
    [KYCStatus] NVARCHAR(50) NULL,
    [KYCDocument] VARBINARY(MAX) NULL,
    [Verified] DATETIME2 NULL,
    [VerifiedByID] UNIQUEIDENTIFIER NULL,
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO


-- TABLE 24: EMPLOYEE ROLE --

CREATE TABLE [EmployeeRole] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [EmployeeID] UNIQUEIDENTIFIER NOT NULL,
    [RoleID] UNIQUEIDENTIFIER NOT NULL,
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 25: REFRESH TOKENS --

CREATE TABLE [RefreshTokens] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [EmployeeID] UNIQUEIDENTIFIER NOT NULL,
    [Token] NVARCHAR(255) NOT NULL UNIQUE,
    [ExpiresAt] DATETIME2 NOT NULL,
    [RevokedAt] DATETIME2 NULL,
    [RevokedByIp] NVARCHAR(45) NULL,
    [ReplacedToken] NVARCHAR(255) NULL,
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

-- TABLE 26: AUTH MANAGER --

CREATE TABLE [AuthManager] (
    [ID] UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    [EmployeeID] UNIQUEIDENTIFIER NOT NULL UNIQUE,
    [PasswordHash] NVARCHAR(255) NOT NULL,
    [PasswordResetToken] NVARCHAR(255) NULL,
    [PasswordResetTokenExpires] DATETIME2 NULL,
    [IsLoginOnHold] BIT NULL,
    [LastLoginDate] DATETIME2 NULL,
    [FailedLoginAttempts] INT,
    [LastFailedLoginAttemptOn] DATETIME2 NULL,
    
    -- System audit columns
    [IsActive] BIT DEFAULT 1,
    [IsDeleted] BIT DEFAULT 0,
    [Created] DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    [CreatedByID] UNIQUEIDENTIFIER NOT NULL,
    [Modified] DATETIME2 NULL,
    [ModifiedByID] UNIQUEIDENTIFIER NULL,
    [Deleted] DATETIME2 NULL,
    [DeletedByID] UNIQUEIDENTIFIER NULL
);
GO

USE [master];
GO